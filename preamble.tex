\documentclass[a4paper]{article}

% PACKAGES
\PassOptionsToPackage{no-math}{fontspec}
\usepackage{amsmath, amssymb}
\usepackage{enumitem}
\usepackage{setspace}
\usepackage{indentfirst}
\usepackage[export]{adjustbox}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage[framed]{ntheorem}
\usepackage{tabularray}
\usepackage[UTF8]{ctex}
\usepackage{multirow}
\usepackage{physics}
\usepackage[T1]{fontenc}
\usepackage[strict]{changepage}
\usepackage{pgfplots}
\usepackage{tikz}
\usetikzlibrary{
    patterns,
    arrows,
    positioning,
    calc,
    fadings,
    shapes,
    decorations.markings,
    matrix
}
\usepackage{tikz-3dplot}
\usepackage{xcolor}
\usepackage{framed}
\usepackage{etoolbox}
\usepackage{wrapfig}
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{XCharter}
\usepackage{unicode-math}
\usepackage{xeCJK}
\usepackage[colorlinks=true, linkcolor=red]{hyperref}
\usepackage{geometry}

\setmathfont{XCharter-Math}
% Fandol fonts are provided by the environment setup script.
\setCJKmainfont[
    BoldFont=FandolSong-Bold
]{FandolSong}
\setCJKsansfont[
    BoldFont=FandolHei-Bold
]{FandolHei}

\geometry{a4paper, left=27mm, right=27mm, top=24mm, bottom=24mm,}

\setlist[enumerate]{nosep}
\setlist[itemize]{nosep}
\setenumerate[1]{label=(\arabic{*})}
\setenumerate[2]{label=(\alph{*})}

\graphicspath{ {./images/} }
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
\fancyfoot[C]{\thepage}
\setlength{\headheight}{14.5pt}

\everymath{\displaystyle}

\def\*#1{\mathbf{#1}} 
\def\+#1{\mathcal{#1}} 
\def\-#1{\mathrm{#1}}
\def\^#1{\mathbb{#1}}
\def\!#1{\mathtt{#1}}
\def\bb#1{\mathbb{#1}}
\def\@#1{\mathscr{#1}}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\tuple}[1]{\left(#1\right)} 
\newcommand{\eps}{\varepsilon}
\newcommand{\inner}[2]{\langle #1,#2\rangle} 
\newcommand{\tp}{\tuple}
\renewcommand{\mid}{\;\middle\vert\;} 
\newcommand{\cmid}{\,:\,}
\newcommand{\numP}{\#\mathbf{P}} 
\renewcommand{\P}{\mathbf{P}}
\newcommand{\defeq}{:=} 
\renewcommand{\d}{\,\-d}
\newcommand{\ol}{\overline}
\newcommand{\Var}[2][]{\mathbf{Var}_{#1}\left[#2\right]}
\renewcommand{\Pr}[2][]{\mathbf{Pr}_{#1}\left[#2\right]}
\newcommand{\E}[2][]{\mathbf{E}_{#1}\left[#2\right]}
\renewcommand{\emptyset}{\varnothing}
\newcommand{\argmin}{\mathop{\arg\min}}
\newcommand{\argmax}{\mathop{\arg\max}}
\newcommand{\wh}{\widehat}

\theoremstyle{plain}
\theoremheaderfont{\bfseries\upshape}
\theorembodyfont{\normalfont}
\theoremseparator{.}
\theoremframepreskip{0.5\baselineskip}
\theoremframepostskip{0.5\baselineskip}
\theoreminframepreskip{0ex}
\theoreminframepostskip{0ex}
\newframedtheorem{question}{问题}

\theoremstyle{nonumberbreak}
\theoremheaderfont{\bfseries\upshape}
\theorembodyfont{\normalfont}
\theoremseparator{:}
\theorempreskip{0.5\baselineskip}
\theorempostskip{0.5\baselineskip}
\newtheorem{answer}{解答}

\definecolor{quoteshade}{RGB}{236,242,252}
\definecolor{quoteleft}{RGB}{188,232,241}
\colorlet{shadecolor}{quoteshade}

\newlength{\quoteleftsep}
\setlength{\quoteleftsep}{0em}
\newlength{\quoteleftwidth}
\setlength{\quoteleftwidth}{3pt}

\newenvironment{quoteframe}{%
    \def\FrameCommand{%
        {\color{quoteleft}\vrule width \quoteleftwidth}%
        \hspace{\quoteleftsep}%
        \fboxsep=\FrameSep%
        \colorbox{quoteshade}%
    }%
    \MakeFramed{%
        \advance\hsize-\quoteleftsep%
        \advance\hsize-\quoteleftwidth%
        \advance\hsize-\width%
        \FrameRestore%
    }%
}{\endMakeFramed}

\theoremstyle{nonumberbreak}
\theoremheaderfont{\bfseries\upshape}
\theorembodyfont{\normalfont}
\theoremseparator{}
\theorempreskip{0.5\baselineskip}
\theorempostskip{0.5\baselineskip}
\theoremprework{\begin{quoteframe}}
\theorempostwork{\end{quoteframe}}

\newtheorem{quotebox}{}

\theoremprework{}
\theorempostwork{}

\newenvironment{proof}{{\noindent\it Proof.}\par}{\hfill $\square$\par}

\allowdisplaybreaks
\setlength{\parindent}{0pt}
\setlength{\lineskip}{\baselineskip-\ccwd}
\setlength{\lineskiplimit}{2pt}
\setlength{\abovedisplayskip}{4pt}
\setlength{\belowdisplayskip}{4pt}
\setlength{\abovedisplayshortskip}{4pt}
\setlength{\belowdisplayshortskip}{4pt}
