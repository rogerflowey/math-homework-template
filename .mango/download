#!/usr/bin/env bash
set -euo pipefail

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
repo_root="$(cd "$script_dir/.." && pwd)"
user_root="${MANGO_USER_PATH:-$repo_root}"

source "$repo_root/.mango/venv/bin/activate"

if [[ ! -d "$user_root" ]]; then
	echo "Error: MANGO_USER_PATH points to missing directory: $user_root" >&2
	exit 1
fi

# Run downloader from the user repo so relative paths resolve there.
(
	cd "$user_root"
	python3 "$repo_root/note_downloader.py" "$@"
)
